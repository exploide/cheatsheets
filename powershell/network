---
syntax: powershell
---
# Download file via HTTP
(New-Object System.Net.WebClient).DownloadFile("http://example.org/file.txt", "C:\Windows\TEMP\file.txt")

# Download string via HTTPS and disable certificate validation
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}
(New-Object System.Net.WebClient).DownloadString("https://example.org/")

# Send POST data via HTTP
Invoke-WebRequest -Uri 192.0.2.1 -Method Post -Body DATA
echo DATA | Invoke-WebRequest -Uri 192.0.2.1 -Method Post

# Get services listening on TCP ports
Get-NetTCPConnection -State Listen | Select-Object -Property LocalAddress,LocalPort,OwningProcess,@{'Name'='ProcessName';Expression={(Get-Process -Id $_.OwningProcess).ProcessName}}

# Get and set network routes (for permanent omit -PolicyStore)
Get-NetRoute
New-NetRoute -DestinationPrefix 10.0.0.0/24 -NextHop 192.0.2.1 -InterfaceIndex 9 -PolicyStore ActiveStore

# Get proxy settings of current user
Get-ItemProperty -Path "Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings"

# Get configured wifi networks
# Export all or specified wifi profile; with cleartext key if local admin
netsh wlan show profiles
netsh wlan export profile key=clear [ProfileName]
